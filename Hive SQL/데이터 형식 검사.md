-- T_SONG에 전부 들어가있는 행인지
select t2.f_songcd from match_db.t_song t1 left join match_db.t_song_sch1 t2 on t1.f_songcd=t2.f_songcd where t1.f_songcd is null; -- 0
select t2.f_songcd from match_db.t_song t1 left join match_db.t_artist_sch1 t2 on t1.f_songcd=t2.f_songcd where t1.f_songcd is null; -- 0
select t2.f_songcd from match_db.t_song t1 left join match_db.t_right_sch1 t2 on t1.f_songcd=t2.f_songcd where t1.f_songcd is null; -- 0

-- T_SONG 데이터 형식 검사
SELECT
  f_regdt_song,
  f_regym_song,
  f_announce_day,
  f_nat,
  f_announce_ym,
  f_modidt_song,

  CASE WHEN unix_timestamp(f_regdt_song, 'yyyy-MM-dd') IS NOT NULL
       THEN 'OK' ELSE 'NG' END AS chk_regdt,

  CASE WHEN unix_timestamp(concat(f_regym_song,'01'), 'yyyyMMdd') IS NOT NULL
       THEN 'OK' ELSE 'NG' END AS chk_regym,

  CASE WHEN unix_timestamp(nvl(f_announce_day, '00000000'), 'yyyyMMdd') IS NOT NULL
       THEN 'OK' ELSE 'NG' END AS chk_announce_day,

  CASE WHEN unix_timestamp(concat(nvl(f_announce_ym, '00000000'),'01'), 'yyyyMMdd') IS NOT NULL
       THEN 'OK' ELSE 'NG' END AS chk_announce_ym,

  CASE WHEN unix_timestamp(nvl(f_modidt_song, '0000-00-00 00:00:00'), 'yyyy-MM-dd HH:mm:ss') IS NOT NULL
       THEN 'OK' ELSE 'NG' END AS chk_modidt

FROM
  match_db.t_song
WHERE
      unix_timestamp(f_regdt_song, 'yyyy-MM-dd') IS NULL
   OR unix_timestamp(concat(f_regym_song,'01'), 'yyyyMMdd') IS NULL
   OR unix_timestamp(nvl(f_announce_day, '00000000'), 'yyyyMMdd') IS NULL
   OR unix_timestamp(concat(nvl(f_announce_ym, '00000000'),'01'), 'yyyyMMdd') IS NULL
   OR unix_timestamp(nvl(f_modidt_song, '0000-00-00 00:00:00'), 'yyyy-MM-dd HH:mm:ss') IS NULL
;

-- T_MAP_HIST 형식 검사
SELECT
  f_regdate
FROM
  match_db.t_map_hist
WHERE
  unix_timestamp(f_regdate, 'yyyy-MM-dd HH:mm:ss') IS NULL
;



2026-01-08
t_artist_file 테이블에 f_nat K 또는 F가 아닌 행이 3행 있음(8, 0, 0)